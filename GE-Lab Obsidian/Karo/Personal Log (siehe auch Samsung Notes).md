Rot: Debug/Löschen (RGB: 1.0, 0, 0)
Blau: Erklärung (RGB: 0, 0.28, 1.0)
Grün: Funktionalität/Task (RGB: 0.4, 0.95, 0.3)

| **Task**                            | **Beschreibung/Dokumentation**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | **Bearbeitet am** | **Sonstiges, Kommentare, ...** |
| ----------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------- | ------------------------------ |
| Gameplay Loop<br>NICHT MEHR AKTUELL | **Ziel: **<br>--> Tag-Nacht-Loop mit 12 Ticks pro Tag bzw. Nacht<br>--> int tickCounter und bool isNight erstellen<br><br>**Dokumentation:**<br>- in Level-Blueprint implementiert<br>- Was sind Level-Blueprints:<br>A **Level Blueprint** is a specialized type of **Blueprint** that acts as a level-wide global event graph. Each level in your project has its own Level Blueprint created by default that can be edited within the Unreal Editor, however new Level Blueprints cannot be created through the editor interface.<br>Quelle: https://dev.epicgames.com/documentation/en-us/unreal-engine/level-blueprint-in-unreal-engine 23.58 Uhr, 15.10.2024<br><br>- der Tickcounter wird kontinuierlich hochgezählt (hier mit der Leertaste, später durch Wegpunkte) --> dabei immer prüfen, ob tickCounter %12 == 0 && isNight == false, d.h. ob 12h vorbei sind und es gerade Tag ist --> es wird Nacht<br>--> oder: tickCounter %24 == 0 && isNight == true, d.h. ob weitere 12h vergangen sind und es gerade Nacht ist --> es wird Tag<br>--> ist so aufgebaut, da man tagsüber startet --> isNight wird zu Beginn immer false gesetzt<br>![[Pasted image 20241016003116.png]]<br>--> Linie führt nach unten zu Leertasten-Debug-Mode, mit dem Ticks manuell hochgezählt werden können                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 16.10.2024        |                                |
| Gameplay Loop NICHT MEHR AKTUELL    | - Level-Blueprint entfernt, da dortige Variablen nicht erreichbar sind für andere Blueprints --> Tickcounter muss aber später für Licht etc. verfügbar sein<br>--> Blueprint für Ticks (Tickmanager) und für Tag-/Nachtlogik (DayNight)<br><br>TickManager-Blueprint:<br>--> zählt Tickcounter hoch und verwaltet die Intervalle, in denen hochgezählt wird<br>--> aufgrund von Rundungsfehlern durch Truncate kann es dazu kommen, dass nicht alle 250 Einheiten = 0 rauskommt, daher gewisse Range, in der Ticken erlaubt wird<br>![[Pasted image 20241105204551.png]]<br>--> Linie nach SetTickCounter führt nur zu PrintString<br><br>DayNight-Blueprint:<br>--> Logik von Day-Night hat sich nicht verändert, ist nur etwas kompakter geworden, da sobald der Tickcounter auf 24 war, sowohl %12 als auch %24 = 0 ergeben haben --> schneller Switch zwischen Tag und Nacht<br>--> damit nur einmal gewechselt wird: DoOnce-Node, die erst 3 Ticks später zurückgesetzt wird<br>--> zu Beginn Tickcounter über 2 steigen lassen, bevor Tag-Nacht-Logik in Kraft tritt, da 0 % 12 = 0 --> Wechsel<br>![[Pasted image 20241105204827.png]]<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |                   |                                |
| Gameplay Loop<br>AKTUELL            | - bisheriges Inkrementieren des Tick-Counters war frame-abhängig<br>- Ticks werden jetzt abhängig von einem Timer hochgezählt --> damit Timer auch angehalten wird, wenn Karren anhält, wird ein custom Event gefeuert, sobald der Karren anhält --> Timer wird dann mit der verbleibenden Zeit fortgesetzt<br>![[Pasted image 20241110173450.png]]<br>![[Pasted image 20241110173553.png]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |                   |                                |
| Karren fahren: Spline               | **Ziel:**<br>--> Karren fährt automatisch Spline entlang und zählt dabei Ticks hoch<br><br><br>**Dokumentation:**<br>Funktionsweise in BP_SplineMovement:<br>- Timeline läuft von 0 nach 1<br>- jeden Frame wird die Position des Carts geupdatet <br>- es wird interpoliert (Lerp Node) zwischen 0, d.h. dem Startpunkt des Splines und dem Endpunkt des Splines --> die Timeline, die von 0 nach 1 geht, bestimmt hierbei wie sehr das Ergebnis des Lerps an Punkt A oder B ist --> wird auf Dauer immer näher an B, d.h. dem Endpunkt des Splines liegen<br>- der Update-Output der Timeline-Node wird jeden Frame getriggert, solange die Timeline aktiv ist --> dadurch wird die Cart Position und Rotation jeden Frame geupdatet<br>- damit der Karren stabil und ohne Ruckeln fährt, darf der Spline nicht zu viele Spline-Points besitzen --> beim Spline zeichnen Spline-Abstand hoch setzen (1000)<br><br>--> siehe Kommentare im Code<br><br>BP_SplineMovement:<br>- Actor mit Spline --> kann in Szene eingefügt werden, Spline zeichnen, gesetztes Cart (in Editor) fährt auf diesem Spline<br>![[Pasted image 20241027180815.png]]<br>![[Pasted image 20241027181054.png]]<br>--> Timeline-Length bestimmt wie schnell Cart fährt<br><br>Tangentenvektor:<br>Ein Tangentenvektor an einem Spline ist ein Vektor, der die Richtung und Geschwindigkeit der Bewegung entlang des Splines an einem bestimmten Punkt beschreibt. Er zeigt an, in welche Richtung der Spline an diesem Punkt verläuft und wie stark die Änderung des Splines ist. Dies ist besonders nützlich in der Computergrafik, Robotik und bei der Simulation von Bewegungen, da der Tangentenvektor hilft, glatte Übergänge und fließende Bewegungen entlang des Splines zu berechnen. https://www.spektrum.de/lexikon/mathematik/tangentenvektor-an-eine-kurve/10230 15.52 Uhr, 27.10.2024<br><br><br>Level-Blueprint: NICHT MEHR AKTUELL<br>![[Pasted image 20241027181332.png]]<br>--> Reference auf Spline-Movement von Scene --> Länge des Splines holen (wird in BP_SplineMovement gesetzt) --> Modulo Tickintervall (auf Screenshot: 50) == 0 rechnen und entsprechend TickCounter erhöhen --> geht dann über in Tag/Nacht-Rhythmus-Logik (siehe oben) | 26.-27.10.2024    |                                |
| Karren fahren: Steuerung            | Enhanced Input System<br>- Input-Actions definieren und mit Mapping Context auf Tasten mappen --> Mapping Context muss im PlayerController enabled werden<br><br>PlayerController<br>A PlayerController is the interface between the Pawn and the human player controlling it. The PlayerController essentially represents the human player's will.<br>--> Events für Steuerung werden in PlayerController gefeuert und dann entsprechend weiterverarbeitet<br>--> enthält gesamte Steuerung des Wagens<br><br>Karren kann auf drei Lanes fahren --> Links, Rechts und Mitte<br>--> zwischen diesen über A und D wechseln<br>--> Karren folgt dauerhaft dem Spline und erhält Offset nach links bzw. rechts --> wird in PlayerController entsprechend berechnet und im Karren gesetzt (offset in Cart) und auf die Location des Karrens addiert (in SplineMovement)<br><br>Driving left/right (in PlayerController)<br>- prüfen, ob Karren in der Mitte oder links bzw. rechts fährt --> abhängig davon das Offset berechnen und Lerpen --> offset speichert das Offset und rechnet es in SplineMovement zur Location des Wagens dazu<br>- von links zur Mitte (nach rechts fahren): von -pathModifier zu 0 lerpen<br>- von Mitte nach rechts (nach rechts fahren): von 0 zu pathModifier lerpen<br>- von rechts zur Mitte (nach links fahren): von pathModifier zu 0 lerpen<br>- von Mitte nach links fahren (nach links fahren): von 0 zu -pathModifier lerpen<br>- Timelines um korrekt von links nach rechts zu lerpen --> siehe SplineMovement<br><br>Start/stop driving (in PlayerController)<br>- trigger Event in Cart, das den bool isDriving setzt<br>- Karren darf nicht anhalten, während er nach links/rechts fährt --> bool isChangingLanes muss false sein, damit angehalten werden kann<br>--> bool isChangingLanes wird nach den Lerps gesetzt<br>![[Pasted image 20241110174304.png]]                                                                                                                                                                                                                                                                                                                                       | -                 |                                |
| GameMode                            | - GameMode für "Regeln", die festgelegt werden müssen, z.B. den Default-PlayerController<br>- Cart als Default Pawn festlegen --> Karren wird dadurch am PlayerStart gespawnt und Kamera als Default ausgewählt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                   |                                |
| Kamera folgt Karren                 | - Kamera wird zu Cart hinzugefügt --> verhält sich wie eine Third-Person-Kamera und folgt dem Karren<br>![[Pasted image 20241109194843.png]]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                   |                                |
| Pfad wählen                         | 3 Ansätze/Ideen:<br>- neuen Spline-Movement-Actor in Szene mit jeweiligem Spline hinzufügen<br>     --> Problem: viele Actors werden erstellt, Löschen von Actors während der Laufzeit kann ggf. zu Referenz-Problemen führen<br>- vorhandenen Spline in Spline-Movement um Spline-Punkte erweitern<br>     --> Timer für Interpolation sowie Start- und Endpunkt im Spline-Movement müssten neu festgelegt und angepasst werden --> je nach Länge und Anzahl der Spline-Punkte des angehängten Splines problematisch<br>- Spline in Spline-Movement neu setzen<br>    --> Problem: Zugriff auf neue Splines und setzen von Spline-Variable in Spline-Movement --> kleinstes und bewältigbarstes Problem von allen 3 + Logik in Spline-Movement muss nicht angefasst werden --> Vorgang kann mit gewähltem Spline einfach neu gestartet werden --> es muss maximal die Playrate angepasst werden<br><br>--> Option 3 ist es geworden<br><br>Cart:<br>![[Pasted image 20241117160243.png]]<br><br>Player-Controller:<br>--> Events für Inputs bei Pfadwahl --> Linker bzw. rechter Spline wird als neuer Current Spline in Spline-Movement gesetzt<br>![[Pasted image 20241117160328.png]]<br><br>Spline-Movement:<br>--> Event, um neue wählbare Splines zu wählen --> sind mit left/right getaggt<br>     --> wird dann beim Laden der neuen Mapstücke ausgelöst --> späterer Task<br>![[Pasted image 20241117160503.png]]<br>--> Drive-On-Chosen-Spline wird in Player-Controller nach Wählen und Setzen des Splines gefeuert --> Startet Timer komplett neu --> wichtig für Interpolation zwischen Start- und Endpunkt --> direkt danach wird Register-Splines für die nächste Pfadwahl gefeuert --> am Ende des Timers wird das Choose-Path-Event gefeuert --> sorgt dafür dass Cart anhält und die Input-Events verwendet werden können, da bool isChoosingPath true gesetzt wird<br>![[Pasted image 20241117160639.png]]<br><br>Ablauf zusammengefasst:<br>- Map wird befahren --> die zwei nächsten wählbaren Splines werden registriert<br>- am Ende des aktuellen Splines hält der Karren an und es kann ein Spline gewählt werden<br>- Spline wird als currentSpline gesetzt und die Fahrtlogik wird neu gestartet                  |                   |                                |
|                                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |                   |                                |


